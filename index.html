<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Molecule - 5CEO</title>
    <script src="https://cdn.jsdelivr.net/npm/mrjs@latest/dist/mr.js"></script>
    <link rel="stylesheet" type="text/css" href="style.css" />
</head>

<body>

    <mr-app>
      
        <!-- Menu Panel -->
        <mr-panel data-position="0.2 -0.4 0.001" class="bar" style="position: fixed;">
            <mr-div class="bar"> 
            <mr-button class="button" id="toggleObject" onclick="toggleObject()" value="OFF">molecule: ON</mr-button>
            <mr-button class="button" id="togglePanel" onclick="toggleInfo()" value="OFF">info: ON</mr-button>

            <mr-button class="button" onclick="location.href='https://www.rcsb.org/structure/5CEO'">More</mr-button>
        </mr-div>

        </mr-panel>

        <!-- 5CEO Model Loading -->
        <mr-entity id="model" style="visibility:hidden;" data-comp-anchor="type:plane; label: table;">
            <mr-model  data-position="0 0.1 -0.55" class="molecule" src="./assets/histamine/1QFV.glb" ></mr-model>
        </mr-entity>

        <!-- Information Panel
        data-position="0 0 -0.0001"
        
            text properties:
            data-position="-1 0 -1.5" data-rotation="0 30 0"
    -->
        <mr-entity>
        <mr-panel id="panel" class="panel" style="visibility: hidden;" data-position="0.28 0.3 0">
            <mr-div class="layout"> 
            <mr-text class="title">Histamine Molecule</mr-text>
            <mr-text class="paragraph">
                3D Representation of a histamine binding site. Hard to believe that in a small anti-allergen pill there is a
                mega structure of different elements. 
                This 3D immersive visualizer is built with desire to learn more about Pharmacology and to practice my skill of 3D Design and Development.
                This project has no affiliation to Nanome Inc, or my previous employers. 
                <a href="https://github.com/Volumetrics-io/mrjs?tab=readme-ov-file">Built with mr.js</a>
            </mr-text>
        </mr-div>
        </mr-panel>
    </mr-entity>

    </mr-app>

</body>


<script type="module" src="./script.js"></script>

</html>

<script>


var logIndex = 0

function toggleObject() 
{
    
    if (logIndex === 0)
    {
        document.getElementById('toggleObject').innerText = 'molecule: OFF'
        toggleObjectVisibility()
    console.log("button 0")
    }
    else
    {
        document.getElementById('toggleObject').innerText = 'molecule: ON'
        toggleObjectVisibilityOff()
    console.log("button 1")
    }
    logIndex = 1 - logIndex
}

function toggleInfo() 
{
    
    if (logIndex === 0)
    {
        document.getElementById('togglePanel').innerText = 'info: OFF'
        togglePanelVisibility()
    console.log("button 0")
    }
    else
    {
        document.getElementById('togglePanel').innerText = 'info: ON'
        togglePanelVisibilityOff()
    console.log("button 1")
    }
    logIndex = 1 - logIndex
}


//Model Visibility Functions 

    function toggleObjectVisibility() {
        var object = document.getElementById('model')

        if (object.style.visibility === 'hidden' || object.style.visibility === '') {
            object.style.visibility = 'visible'
           
        }

    }

    function toggleObjectVisibilityOff() {
        var object = document.getElementById('model')
            if (object.style.visibility === 'visible' || object.style.visibility === '') {
                object.style.visibility = 'hidden'
            }
        }

//Panel Visibility Functions 

        function togglePanelVisibility() {
        var panel = document.getElementById('panel');

        if (panel.style.visibility === 'hidden' || panel.style.visibility === '') {
            panel.style.visibility = 'visible';
       
      
    }
}

    function togglePanelVisibilityOff() {
        if (panel.style.visibility === 'visible' || panel.style.visibility === '') {
            panel.style.visibility = 'hidden';
        
    }
    }


    // let rig = document.querySelector('#rig')
    //     let panels = document.querySelectorAll('.layout')

    //     let frontIndex = 0

    // function spread() {
    //         let index = 0
    //         let totalWidth = 0

    //         // let forwardVec = getForward(rig)
            
    //         for(let panel of panels) {
    //             totalWidth += panel.width
    //         }
    //         for(let panel of panels) {
    //             if(unfolded) {
    //                 panel.object3D.position.set(0, 0, 0)
    //             } else {
    //                 panel.object3D.position.set(((panel.width) * index) - (totalWidth / panels.length), 0, ((index + 1) % 2) * 0.3)
    //                 index += 1
    //             }

    //             panel.object3D.lookAt(forwardVec)


    //         }

    //         unfolded = !unfolded

    //     }
    

</script>
